# PAYLOAD COMBINADO - Encoded Command + Base64 Conversion + Atomic Test #15
# Este payload vai disparar múltiplas signatures: ENCODED COMMAND, BASE64 TO STRING CONVERTION e ATOMIC T1059.001 - Test #15

# PAYLOAD PRINCIPAL - Comando PowerShell com -EncodedCommand e Base64
powershell.exe -EncodedCommand JABzAD0ATgBlAHcALQBPAGIAagBlAGMAdAAgAEkATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtACgALABbAEMAbwBuAHYAZQByAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoACIASAA0AHMASQBBAEEAQQBBAEEAQQBBAEEARQBBAE8AOQAuAC4ALgAiACkAKQA=

# VARIAÇÕES PARA TESTAR:

# Variação 1: Com -enc (forma abreviada)
powershell.exe -enc JABzAD0ATgBlAHcALQBPAGIAagBlAGMAdAAgAEkATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtACgALABbAEMAbwBuAHYAZQByAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoACIASAA0AHMASQBBAEEAQQBBAEEAQQBBAEEARQBBAE8AOQAuAC4ALgAiACkAKQA=

# Variação 2: Com -e (forma ainda mais abreviada)
powershell.exe -e JABzAD0ATgBlAHcALQBPAGIAagBlAGMAdAAgAEkATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtACgALABbAEMAbwBuAHYAZQByAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoACIASAA0AHMASQBBAEEAQQBBAEEAQQBBAEEARQBBAE8AOQAuAC4ALgAiACkAKQA=

# Variação 3: Comando que usa FromBase64String diretamente
powershell.exe -Command "[System.Convert]::FromBase64String('SGVsbG8gV29ybGQ=')"

# Variação 4: Comando com Text.Encoding e FromBase64String (vai pegar ambas as signatures)
powershell.exe -Command "[System.Text.Encoding]::UTF8.GetString([Convert]::FromBase64String('SGVsbG8gV29ybGQ='))"

# Variação 5: Simulação do Atomic Test #15 com Out-ATHPowerShellCommandLineParameter
Out-ATHPowerShellCommandLineParameter -CommandLineSwitchType Hyphen -EncodedCommandParamVariation E -Execute -ErrorAction Stop

# Variação 6: Combo completo - Encoded + Base64 + Atomic Test #15
powershell.exe -EncodedCommand JABPAHUAdAAtAEEAVABIAFAAbwB3AGUAcgBTAGgAZQBsAGwAQwBvAG0AbQBhAG4AZABMAGkAbgBlAFAAYQByAGEAbQBlAHQAZQByACAALQBDAG8AbQBtAGEAbgBkAEwAaQBuAGUAUwB3AGkAdABjAGgAVAB5AHAAZQAgAEgAeQBwAGgAZQBuACAALQBFAG4AYwBvAGQAZQBkAEMAbwBtAG0AYQBuAGQAUABhAHIAYQBtAFYAYQByAGkAYQB0AGkAbwBuACAARQA=

# DECODIFICAÇÃO DOS PAYLOADS BASE64 (para referência):
# JABzAD0ATgBlAHcALQBPAGIAagBlAGMAdAAgAEkATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtACgALABbAEMAbwBuAHYAZQByAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoACIASAA0AHMASQBBAEEAQQBBAEEAQQBBAEEARQBBAE8AOQAuAC4ALgAiACkAKQA=
# Decodifica para: $s=New-Object IO.MemoryStream(,[Convert]::FromBase64String("H4sIAAAAAAAEAO9...")

# SGVsbG8gV29ybGQ=
# Decodifica para: Hello World

# JABPAHUAdAAtAEEAVABIAFAAbwB3AGUAcgBTAGgAZQBsAGwAQwBvAG0AbQBhAG4AZABMAGkAbgBlAFAAYQByAGEAbQBlAHQAZQByACAALQBDAG8AbQBtAGEAbgBkAEwAaQBuAGUAUwB3AGkAdABjAGgAVAB5AHAAZQAgAEgAeQBwAGgAZQBuACAALQBFAG4AYwBvAGQAZQBkAEMAbwBtAG0AYQBuAGQAUABhAHIAYQBtAFYAYQByAGkAYQB0AGkAbwBuACAARQA=
# Decodifica para: Out-ATHPowerShellCommandLineParameter -CommandLineSwitchType Hyphen -EncodedCommandParamVariation E
